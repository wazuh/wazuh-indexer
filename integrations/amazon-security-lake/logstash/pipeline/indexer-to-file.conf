input {
   opensearch {
      hosts =>  ["wazuh.indexer:9200"]
      user  =>  "${INDEXER_USERNAME}"
      password  =>  "${INDEXER_PASSWORD}"
      ssl => true
      ca_file => "/usr/share/logstash/root-ca.pem"
      index =>  "wazuh-alerts-4.x-*"
      query =>  '{ "query": { "match_all": {}} }'
      schedule => "* * * * *"
   }
}


output {
   stdout { 
      id => "output.stdout"
      codec => rubydebug
   }
   file {
      id => "output.file"
      path => "/var/log/logstash/indexer-to-file-%{+YYYY-MM-dd-HH}.log"
      file_mode => 0644
      codec => json
   }
}
