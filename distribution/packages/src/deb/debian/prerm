#!/bin/bash

# Copyright OpenSearch Contributors
# SPDX-License-Identifier: Apache-2.0
#
# The OpenSearch Contributors require contributions made to
# this file be licensed under the Apache-2.0 license or a
# compatible open source license.

# deb wazuh-indexer prerm script

set -e

case "$1" in
    upgrade|deconfigure)
    ;;
    remove)
        echo "Running Wazuh Indexer Pre-Removal Script"
        # Stop existing service
        if command -v systemctl >/dev/null && systemctl is-active wazuh-indexer.service >/dev/null; then
            echo "Stop existing wazuh-indexer.service"
            if ! systemctl --no-reload stop wazuh-indexer.service; then
                echo "Error while stopping the wazuh indexer service" >&2
                exit 1
    fi
        fi
        if command -v systemctl >/dev/null && systemctl is-active wazuh-indexer-performance-analyzer.service >/dev/null; then
            echo "Stop existing wazuh-indexer-performance-analyzer.service"
            systemctl --no-reload stop wazuh-indexer-performance-analyzer.service
        fi
    ;;
    failed-upgrade)
    ;;
    *)
        echo "prerm called with unknown argument \`$1'" >&2
        exit 0
    ;;
esac

exit 0
